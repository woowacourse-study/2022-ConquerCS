# TCP 3 way handshake & 4 way handshake

### 

### reference

- [[λ„¤νΈμ›ν¬] 3-way / 4-way Handshake λ€? (tistory.com)](https://bangu4.tistory.com/74)



## 3 way handshake

> μ •ν™•ν• μ „μ†΅μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ μ—°κ²°μ„ μ„±λ¦½ν•κΈ°κΉμ§€ κ±°μΉλ” κ³Όμ •

- SYN: λ³΄λ‚΄λ” κ²ƒ
- ACK: λ°›μ•λ‹¤λ” μ‹ νΈ

### 

### κ³Όμ •

- ν΄λΌμ΄μ–ΈνΈ SYN (x) β†’ μ„λ²„
  - μƒνƒ
    - ν΄λΌμ΄μ–ΈνΈ: SYN_SENT
    - μ„λ²„: Wait for Client
  - π§ : ν΄λΌμ΄μ–ΈνΈ μ½μ—μ„ ν•λ‚λ¥Ό λ³΄λ‚΄ λ³Έλ‹¤
- μ„λ²„ ACK(x + 1), SYN(y) β†’ ν΄λΌμ΄μ–ΈνΈ
  - μƒνƒ
    - μ„λ²„: SYN_RECEIVED
  - π§ : μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈ κ²ƒμ„ μ λ°›λ” κ²ƒ ν™•μΈ ν›„ μ„λ²„ μ½μ—μ„λ„ ν•λ‚λ¥Ό λ³΄λ‚΄ λ³Έλ‹¤
- ν΄λΌμ΄μ–ΈνΈ ACK(y + 1) β†’ μ„λ²„
  - μƒνƒ
    - μ„λ²„: ESTABLISHED
  - π§ : ν΄λΌμ΄μ–ΈνΈλ„ μ„λ²„ κ²ƒμ„ μ λ°›λ” κ²ƒ ν™•μΈ λλ©΄ μ „μ†΅μ΄ μ λλ‹¤κ³  νλ‹¨ β†’ μ—°κ²° μ„±λ¦½



## 4 way handshake

> μ—°κ²°μ„ ν•΄μ ν•κΈ° μ „ λ¨λ“  ν†µμ‹ μ΄ λλ‚ κ²ƒμ„ ν™•μΈν•λ” κ³Όμ •

- FIN: μ—°κ²° μΆ…λ£ ν”λκ·Έ
  - π§ : λ‚λ” λ³ΌμΌ λ~~ μ΄λΌκ³  λ§ν•΄μ£Όλ” κ²ƒ

### 

### κ³Όμ •

- ν΄λΌμ΄μ–ΈνΈ FIN β†’ μ„λ²„
  - μƒνƒ
    - ν΄λΌμ΄μ–ΈνΈ: FIN_WAIT
- μ„λ²„ ACK β†’ ν΄λΌμ΄μ–ΈνΈ
  - μƒνƒ
    - μ„λ²„: CLOSE_WAIT
    - π§ : μ•„μ§ λ λ³΄λ‚Έ λ°μ΄ν„° μμ„ μ μμΌλ‹ λ°”λ΅ λ‹«μ§€ μ•κ³  λ€κΈ°
- μ„λ²„ λ°μ΄ν„° μ „μ†΅ μ™„λ£ ν›„ FIN β†’ ν΄λΌμ΄μ–ΈνΈ
  - μƒνƒ
    - μ„λ²„: LAST_ACK
- ν΄λΌμ΄μ–ΈνΈ ACK β†’ μ„λ²„
  - μƒνƒ
    - ν΄λΌμ΄μ–ΈνΈ: TIME_WAIT
    - π§ : μ„λ²„λ” λ°μ΄ν„°λ¥Ό λ‹¤ λ³΄λƒμ§€λ§ μ „μ†΅μ— μ†μ”λλ” μ‹κ°„μ΄ μμ–΄ ν΄λΌμ΄μ–ΈνΈλ” μ•„μ§ λ λ°›μ•μ„ μ μμΌλ‹ λ€κΈ°
- μ„λ²„λ” ACK ν™•μΈ ν›„ μ†μΌ“ Closed, ν΄λΌμ΄μ–ΈνΈλ” TIME_WAIT λλ‚λ©΄ μ†μΌ“ Closed
  - π§ : ν΄λΌμ΄μ–ΈνΈ λ³Ό μΌ λ β†’ μ„λ²„ λ°μ΄ν„° λ–¨μ΄ β†’ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ–¨μ΄ ν• λ°μ΄ν„°κΉμ§€ λ‹¤ μμ‹  μ™„λ£ β†’ μ—°κ²° ν•΄μ 
















