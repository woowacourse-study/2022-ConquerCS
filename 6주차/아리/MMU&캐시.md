# MMU & 캐시

## MMU란?

:  논리 주소를 물리주소로 변환하며 메모리 보호나 캐시 관리 등 CPU의 메모리 접근을 총 관리

- 장점
    - 논리 주소가 생김으로써 프로세스가 실제 메모리 크기보다 작아도 실행할 수 있다.
    - 사용자가 물리주소를 알 필요가 없어진다.

## MMU의 역할

- 메모리 보호
    - 각 프로세스별로 독립적인 공간만 접근 가능하도록 하고, 잘못된 접근이라면 trap을 발생시키며 보호
    - base와 base+limit까지만 접근 가능!
    - 안정성으로 위해 base와 limit은 커널모드에서만 수정 가능
- 메모리 과할당
    - 논리 주소로 인해 메모리가 넘치는 경우 프로세스 하나를 swap out 하여 빈 공간 확보
    - 과정
        1. 프로세스 실행 중 페이지 부재 발생
        2. 페이지 부재가 발생한 페이지 위치를 디스크에서 찾음
        3. 메모리에 빈 프레임이 있는지 확인
            1. 있다면 해당 프레임 사용
            2. 없다면 victim 프레임 선정하여 디스크에 기록하고 페이지 테이블 업데이트
        4. 빈 프레임에 페이지 할당하고, 페이지 테이블 업데이트
- 페이지 교체시의 오버헤드 감소시키는 법
    - 페이지가 수정되었는지 여부를 bit에 저장하여 수정된 경우에만 디스크에 기록
    - 상황에 따라 페이지 교체 알고리즘을 선정

## 캐시

: 주기억장치에 저장된 내용의 일부를 임시로 저장해두는 기억장치

- CPU가 사전에 접근했던 데이터를 재접근 할 때 메인메모리에 다녀오는 비용일 줄이기 위해 캐시에 저장
- 캐시에 존재한다면? 바로 CPU로 전송
- 캐시에 존재하지 않는다면? 메인메모리 접근하여 캐시에 저장 및 CPU로 전송
- 지역성
    - 캐시를 통해 성능르을 많이 높이려면 CPU가 어떤 데이터를 원할지 예측해야함. 이 적중률을 높이기 위해 지역성의 원리 이용
    - 지역성이란? 기억 장치 내의 정보를 균일하게 액세스하는 것이 아니라 `한 순간에 특정부분을 집중적으로 참조`하는 특성
    - 시간 지역성 : 최근에 참조된 주소의 내용은 곧 다음에도 참조되는 특성
    - 공간 지역성 : 최근에 참조된 주소와 인접한 주소의 내용이 다시 참조되는 특성
- 캐싱 라인
    - 캐시에 있는 데이터를 모두 순회하며 데이터를 찾는 것은 비효율적이다. 더욱 빠르게 캐시에 저장된 데이터를 찾아내기 위해 map 등의 자료구조를 이용하는 것!
